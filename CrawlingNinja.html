<!doctype html>
<html>
<head>
<base href="http://newsmartwave.net/html/venedor/green/index.html">
<meta charset="utf-8">
<title>CrawlingNinja</title>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
<script type="text/javascript">
var urlList = {
};

var currentIndex = 0;

function display(data)
{	
	var list = document.getElementById("links");
	var url = data.query.results.results.a;
	
	for(var i=0; i<url.length; i++)
	{
		var address = url[i].href;
		
		if ((address === undefined) || (address.charAt(0) === '#'))
		{
			 continue;	 
		}
		
		
				
		var anchor = document.createElement("a");
		anchor.setAttribute("href", address);
		if(undefined !== urlList[anchor.href])
		{
			continue;	
		}
		urlList[anchor.href] = false;
		var listitem = document.createElement("li");
		listitem.textContent = anchor.href;
	
		list.appendChild(listitem);	
	}
	
	/*for (var pname in urlList)
	{
		var listitem = document.createElement("li");
		listitem.textContent = pname;
	
		list.appendChild(listitem);	
	}*/
	
	var keys = Object.keys(urlList);
	crawlUrl(keys[currentIndex]);
	currentIndex++;
}

function crawlUrl(url) {
	
	var statusDiv = document.getElementById("url");
	statusDiv.textContent = url;
	url = encodeURI(url);
	
	
	$.ajax( {
		url:  "https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20data.html.cssselect%20where%20url%3D%22" + url +"%22%20and%20css%3D%22a%22&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys",
		dataType: "jsonp",
		async: false,
		jsonpCallback: 'display',
		contentType: "application/json",
	});
}

window.addEventListener("load",initialise);
function initialise() {
crawlUrl("http://newsmartwave.net/html/venedor/green/index.html");
}



</script>

<style>

body {
	font-family: "Open Sans";
	font-size: 14px;
}
.status {
	float: right;
	width: 500px;
	border: 1px solid #ccc;
	background-color: #E5E3E3;
	border-radius: 3px;
	padding: 15px 15px;
	
}
</style>
</head>

<body>

<div class="status">
     Currently crawling:
    <div id="url"></div>
</div>

<div class="bar">
	<ul id="links">
    	
    </ul>
</div>
<script>

//$.get("http://localhost/CrawlingNinja/test.txt", function(data) {
	//alert(data);
//});

</script>

<!--<script src='https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20data.html.cssselect%20where%20url%3D%22http%3A%2F%2Fnewsmartwave.net%2Fhtml%2Fvenedor%2Fgreen%2Findex.html%22%20and%20css%3D%22a%22&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=display'></script>-->

</body>
</html>




